\chapter{Symbols}
\label{chapter:symbols}

\section{Difference operators}

\begin{definition}
\label{definition:difference_operators}
    Let $q \in \SmoothFunctions{\Group}$.
    The \emph{difference operator} associated with $q$, $\DifferenceOperator{q}$ is defined via
    \begin{align*}
        \DifferenceOperator{q} \Fourier f \defeq \Fourier\{q f\},
    \end{align*}
    where $f \in \Schwartz{\Group}$.

    Moreover, if $q$ vanishes at order $k \in \N$,
    we shall say that $\DifferenceOperator{q}$ is a \emph{difference operator of order $k$}.
\end{definition}

\begin{definition}
\label{definition:admissibility_of_difference_operators}
\index{difference operators!admissibility}
    A finite collection $q_1$, \dots, $q_M \in \SmoothFunctions{\Group}$ of smooth functions is said to be \emph{admissible}
    if $\dd q_j(e) \neq 0$ for each $j \in \{1, \dots, M\}$
    and if
    \begin{align*}
        \rank(\dd q_1(e), \dots, \dd q_m(e)) = \dim \Group.
    \end{align*}

    Moreover, if
    \begin{align*}
        \bigcap_{j = 1}^M \{ q_j = 0 \} = \{e\},
    \end{align*}
    we shall say that the collection is \emph{strongly admissible}.

    A collection of \emph{difference operators} is called \emph{(strongly) admissible}
    if the associated smooth functions form a \emph{(strongly) admissible} collection.
\end{definition}

Using \cite[Lemma 4.4]{RuzhanskyTurunenWirth10}, we can show

\begin{lemma}
    There exists a strongly admissible family $q_1$, \dots, $q_M \in \SmoothFunctions{\Group}$ on $\Group$.
\end{lemma}

\begin{remark}
    From now on, we fix an admissible family $q_1, \dots, q_{\dimDifferenceOperators}$ on $\Group$.
    Given $\alpha \in \N^{\dimDifferenceOperators}$, we let
    \begin{align*}
        q^\alpha = \prod_{j = 1}^{\dimDifferenceOperators} q_j^{\alpha_j}.
    \end{align*}
    Moreover, we let $\DifferenceOperatorOrder{\alpha}$ be the difference operator associated with the smooth function
    \begin{align*}
        \Group \to \C : g \mapsto q^\alpha(g^{-1}).
    \end{align*}
\end{remark}

\section{Symbol and operators classes}

\begin{definition}[Symbol classes]
\label{definition:symbol_classes}
    Let $m \in \R$ and fix $\rho, \delta \in \R$ such that $0 \leq \rho \leq \delta \leq 1$.
    We shall say that a map
    \begin{align*}
        \sigma : \Group \times \VectorSpace \mapsto \End(\SmoothFunctions \CompactGroup)
    \end{align*}
    is a \emph{symbol of order $m$ and of type $(\rho, \delta)$} if the following conditions are satisfied.
    \begin{enumerate}
        \item
            For each $F \in \SmoothFunctions \CompactGroup$ and each $k \in \CompactGroup$,
            the map
            \begin{align*}
                (g, \lambda) \mapsto \sigma(g, \lambda) F(k)
            \end{align*}
            is smooth.
        \item
            For each $\beta \in \N^{\dim \Group}$,
            $\LeftDifferentialOperator \beta \sigma(g, \dummy) \in \TemperedDistributions {\dualGroup \Group}$
            for each $g \in \Group$ and the map
            \begin{align*}
                g \in \Group \mapsto \LeftDifferentialOperator \beta \sigma(g, \dummy) \in \TemperedDistributions {\dualGroup \Group}
            \end{align*}
            is continuous.
        \item
            For each $\alpha \in \N^{\dim \Group}$, $\beta \in \N^m$, and each $\gamma \in \R$,
            the operator
            \begin{align*}
                \Rep{\lambda} \BesselPotential{\rho \abs\alpha - m - \delta \abs\beta + \gamma} \LeftDifferentialOperator{\beta} \DifferenceOperatorOrder{\alpha} \sigma(g, \lambda) \Rep{\lambda} \BesselPotential{-\gamma}
            \end{align*}
            is bounded in $\Lebesgue 2 \CompactGroup$ by a finite constant that does not depend on $g \in \Group$ or $\lambda \in \VectorSpace$.
    \end{enumerate}

    The set $\SymbolClass{m}{\rho, \delta}$ will be used to denote the set of all symbols of order $m$ and type $(\rho, \delta)$.
\end{definition}

\begin{lemma}
    Suppose that $m_1, m_2 \in \R$ and $\rho_1, \rho_2, \delta_1, \delta_2 \in [0, 1]$.
    If the following inequalities hold
    \begin{align*}
        m_1 \leq m_2, \quad \delta_1 \leq \delta_2, \quad \rho_1 \geq \rho_2,
    \end{align*}
    then $\SymbolClass {m_1} {\rho_1, \delta_1} \subset \SymbolClass {m_2} {\rho_2, \delta_2}$.
\end{lemma}

\begin{definition}[Smoothing symbols]
\label{definition:smoothing_symbols}
    We let
    \begin{align*}
        \SmoothingSymbols \defeq \bigcap_{m \in \R} \SymbolClass{m}{1, 0}.
    \end{align*}
    The elements of $\SmoothingSymbols$ will be called \emph{smoothing symbols}.
\end{definition}

\begin{definition}[Operator classes]
\label{definition:operator_classes}
    Let $\sigma \in \SymbolClass{m}{\rho, \delta}$.
    We define the operator $\Op(\sigma)$ via
    \begin{align*}
        \Op(\sigma) \phi(g) \defeq
        \int_\dualGroup\VectorSpace
            \tr\left(\Rep\lambda(g) \sigma(g, \lambda) \Fourier \phi(\lambda)\right)
        \dd \Plancherel{\VectorSpace}(\lambda),
    \end{align*}
    where $\phi \in \Schwartz\Group$, and $g \in \Group$.


    If $T = \Op(\sigma)$ for a certain $\sigma \in \SymbolClass{m}{\rho, \delta}$,
    we shall say that $T$ is an \emph{operator of order $m$ and of type $(\rho, \delta)$}.

    The set of all such operators will be denoted by
    \begin{align*}
        \OperatorClass{m}{\rho, \delta} \defeq \Op(\SymbolClass{m}{\rho, \delta}).
    \end{align*}
    Naturally, an operator in
    \begin{align*}
        \SmoothingOperators \defeq \Op(\SmoothingSymbols)
    \end{align*}
    is called \emph{smoothing}.
\end{definition}

\section{Kernels and quantisation}

\begin{definition}[Kernel of a symbol]
\label{definition:kernel_of_symbol}
    Let $\sigma \in \SymbolClass{m}{\rho, \delta}$.
    For each $g \in \Group$, we let
    \begin{align*}
        \kappa_g \defeq \InverseFourier\{\sigma(g, \dummy)\} \in \TemperedDistributions\Group.
    \end{align*}
    The map
    \begin{align*}
        \kappa : \Group \to \TemperedDistributions\Group : g \mapsto \kappa_g
    \end{align*}
    is called the \emph{kernel} of $\sigma$.
\end{definition}

\begin{lemma}
    Let $\sigma \in \SymbolClass m {\rho, \delta}$,
    and denote by $\kappa$ its associated kernel.
    For each $g \in \Group$,
    $\kappa_g$ is a tempered distribution and
    \begin{align*}
        g \in \Group \mapsto \kappa_g \in \TemperedDistributions \Group
    \end{align*}
    is smooth,
    i.e.\ $\kappa \in \SmoothFunctions {\Group, \TemperedDistributions \Group}$.
\end{lemma}
\begin{proof}
    Let $g \in \Group$ and $\beta \in \N^{\dim \Group}$.
    By ???, $\kappa_g = \InverseFourier \{\LeftDifferentialOperator \beta \sigma(g, \dummy)\}$ is a tempered distribution.
    % TODO: Give reference
    Since the inverse Fourier transform is also continuous,
    the continuity of $\sigma$ in $g$ implies that
    \begin{align*}
        g \mapsto \kappa_g = \InverseFourier \{\LeftDifferentialOperator \beta \sigma(g, \dummy)\}
    \end{align*}
    is continuous.
    This concludes the proof.
\end{proof}

\begin{proposition}[Quantisation]
    Let $\sigma \in \SymbolClass{m}{\rho, \delta}$,
    and denote by $\kappa$ its associated kernel.
    If $\phi \in \Schwartz\Group$, then for each $g \in \Group$, we have
    \begin{align*}
        \Op(\sigma) \phi(g) = \conv{\phi}{\kappa_g}.
    \end{align*}

    In other words, $\kappa$ is the right convolution kernel associated with $\Op(\sigma)$.
\end{proposition}
\begin{proof}
    Let $g \in \Group$ and fix $s < -\max \{\dim \Group/2, \abs m\}$.
    By definition, we know that $\conv \phi \kappa_g \in \Sobolev s$ if and only if
    \begin{align*}
        \Rep \dummy \BesselPotential s \Fourier \{\conv \phi {\kappa_g}\}
        = \Rep \dummy \BesselPotential s \sigma(g, \dummy) \Fourier \phi
    \end{align*}
    belongs to $\LebesgueDual 2 \Group$.
    To show this,
    observe that the above identity implies
    \begin{align*}
        \norm[\SchattenClasses 2 {\Lebesgue 2 \CompactGroup}] {\Rep \dummy \BesselPotential s \Fourier \{\conv \phi {\kappa_g}\}}^2
        \leq C_s \norm[\SchattenClasses 2 {\Lebesgue 2 \CompactGroup}] {\Fourier \phi}^2,
    \end{align*}
    which, since the right-hand side is integrable on $\VectorSpace$,
    means that $\conv \phi {\kappa_g}$ belongs to $\Sobolev s$.
    By Proposition~\ref{proposition:general_Fourier_inverse_formula},
    we get that
    \begin{align*}
        \conv \phi {\kappa_g}(g)
        &= \int_\VectorSpace \tr\left(\Rep \lambda(g) \Fourier \{\conv \phi {\kappa_g}\}\right) \dd \lambda\\
        &= \int_\VectorSpace \tr\left(\Rep \lambda(g) \sigma(g; \lambda) \Fourier \phi(\lambda)\right) \dd \lambda,
    \end{align*}
    which concludes the proof,
    as the right-hand side is exactly $\Op(\sigma) \phi(g)$.
\end{proof}

\section{Link with the H\"ormander classes}

\begin{definition}[Rotation of symbols]
    Let $\tilde \sigma \in \SymbolClass[\GroupDirect]{m}{\rho, \delta}$.
    We define the operator
    \begin{align*}
        \Rotation {\tilde \sigma} : \SmoothFunctions \CompactGroup \to \SmoothFunctions \CompactGroup
    \end{align*}
    via the formula
    \begin{align*}
        \Rotation {\tilde \sigma}(x, k; \lambda) F(u) \defeq \tilde \sigma(x, k; k u^{-1} \lambda) F(u),
    \end{align*}
    where $x, \lambda \in \VectorSpace$, $k, u \in \CompactGroup$, and $F \in \SmoothFunctions \CompactGroup$.

    Similarly, given $\sigma \in \SymbolClass m {\rho, \delta}$,
    we define the operator
    \begin{align*}
        \InverseRotation \sigma : \SmoothFunctions \CompactGroup \to \SmoothFunctions \CompactGroup
    \end{align*}
    via the formula
    \begin{align*}
        \InverseRotation \sigma (x, k; \lambda) F(u) \defeq \sigma(x, k; u k^{-1} \lambda) F(u),
    \end{align*}
    where again $x, \lambda \in \VectorSpace$, $k, u \in \CompactGroup$, and $F \in \SmoothFunctions \CompactGroup$.
\end{definition}

\begin{lemma}
\label{lemma:Y_derivative_on_lambda_variable_of_symbols}
    Let $Y \in \LieAlgebraCompactGroup$, $\sigma \in \SymbolClass m {\rho, \delta}$, $\tilde \sigma \in \SymbolClass[\GroupDirect] m {\rho, \delta}$.
    We have the following expression
    \begin{align*}
        \LeftDifferentialOperatorFirstOrder Y_l \sigma(x, k; l \lambda)
        &= \sum_{j = 1}^{\dim \VectorSpace} \DifferenceOperator{j} \sigma(x, k; l \lambda) \Rep {l Y \lambda} (X_j)\\
        \LeftDifferentialOperatorFirstOrder Y_l \tilde \sigma(x, k; l \lambda)
        &= \sum_{j = 1}^{\dim \VectorSpace} \DifferenceOperator[\VectorSpace]{j} \tilde \sigma(x, k; l \lambda) \Rep[\GroupDirect] {l Y \lambda} (\partial_j),
    \end{align*}
    where $(x, k) \in \GroupDirect$, $\lambda \in \VectorSpace$ and $l \in \CompactGroup$.
\end{lemma}
\begin{proof}
    By definition, we know that
    \begin{align*}
        \LeftDifferentialOperatorFirstOrder Y_l \sigma(x, k; l \lambda)
        &= \eval{\D*{1}{t}}{t = 0} \sigma(x, k; l \exp_\CompactGroup (t Y) \lambda),
    \end{align*}
    which after applying the chain rule, becomes
    \begin{align}
        &\LeftDifferentialOperatorFirstOrder Y_l \sigma(x, k; l \lambda) \notag\\
        &\quad = \sum_{j = 1}^{\dim \VectorSpace} \eval{\D*{1}{s}}{s = 0} \sigma(x, k; l \lambda + s u e_j) \eval{\D*{1}{t}}{t = 0} \ip {l \exp_\CompactGroup (t Y) \lambda} {u e_j}.
        \label{eq:k_differentiation_of_lambda_variable_in_symbol}
    \end{align}

    Now, we observe that
    \begin{align*}
        \eval{\D*{1}{t}}{t = 0} \ip {l \exp_\CompactGroup (t Y) \lambda} {u e_j}
        = \ip {l Y \lambda} {u e_j} = \frac{1}{\i \turn} \Rep {l Y \lambda} (X_j),
    \end{align*}
    while at the same time
    \begin{align*}
        \eval{\D*{1}{s}}{s = 0} \sigma(x, k; l \lambda + s u e_j)
        = \i \turn \DifferenceOperator{j} \sigma(x, k; l \lambda).
    \end{align*}

    Therefore, it follows that~\eqref{eq:k_differentiation_of_lambda_variable_in_symbol} becomes
    \begin{align*}
        \LeftDifferentialOperatorFirstOrder Y_l \sigma(x, k; l \lambda)
        = \sum_{j = 1}^{\dim \VectorSpace} \DifferenceOperator{j} \sigma(x, k; l \lambda) \Rep {l Y \lambda} (X_j).
    \end{align*}

    Now, we turn to the case of symbols on the direct product.
    Again, we start with
    \begin{align*}
        \LeftDifferentialOperatorFirstOrder Y_l \tilde \sigma(x, k; l \lambda)
        &= \eval{\D*{1}{t}}{t = 0} \tilde \sigma(x, k; l \exp_\CompactGroup (t Y) \lambda).
    \end{align*}
    Applying the chain rule, we obtain
    \begin{align}
        \LeftDifferentialOperatorFirstOrder Y_l \tilde \sigma(x, k; l \lambda)
        &= \sum_{j = 1}^{\dim \VectorSpace} \eval{\D*{1}{s}}{s = 0} \tilde \sigma(x, k; l \lambda + s e_j) \eval{\D*{1}{t}}{t = 0} \ip {l \exp_\CompactGroup (t Y) \lambda} {e_j}.
        \label{eq:k_differentiation_of_lambda_variable_in_symbol_2}
    \end{align}

    By definition, it is clear that
    \begin{align*}
        \DifferenceOperator[\VectorSpace]{j} \tilde \sigma(x, k; l \lambda) = \frac 1 {\i \turn} \D{1}[\tilde \sigma]{{\lambda_j} } (x, k, l \lambda),
    \end{align*}
    while
    \begin{align*}
        \eval{\D*{1}{t}}{t = 0} \ip {l \exp_\CompactGroup (t Y) \lambda} {e_j}
        &= \ip {l Y \lambda} {e_j}
        = \frac{1}{\i \turn} \Rep[\GroupDirect] {l Y \lambda} (\partial_j).
    \end{align*}

    Therefore, it follows that \eqref{eq:k_differentiation_of_lambda_variable_in_symbol_2} becomes
    \begin{align}
        \LeftDifferentialOperatorFirstOrder Y_l \tilde \sigma(x, k; l \lambda)
        &= \sum_{j = 1}^{\dim \VectorSpace} \DifferenceOperator[\VectorSpace]{j} \tilde \sigma(x, k; l \lambda) \Rep[\GroupDirect] {l Y \lambda} (\partial_j).
    \end{align}
\end{proof}

\begin{lemma}
\label{lemma:link_between_symbols}
    Let $\sigma$ and $\tilde \sigma$ be symbols on $\Group$ and $\GroupDirect$ respectively be such that
    \begin{align*}
        \Op[\Group] (\sigma) = \Op[\GroupDirect] (\tilde \sigma).
    \end{align*}
    \begin{enumerate}
        \item
            \label{item:action_of_difference_operators}
            If $q \in \SmoothFunctions \Group$,
            then defining $\tilde q(y, l) = q(l y, l)$ yields
            \begin{align*}
                \DifferenceOperator{q} \sigma = \Rotation {\DifferenceOperator[\GroupDirect]{\tilde q} \tilde \sigma}
                \quad \text{and} \quad
                \DifferenceOperator[\GroupDirect]{\tilde q} \tilde \sigma = \InverseRotation {\DifferenceOperator{q} \sigma}.
            \end{align*}
            In particular, $\sigma = \Rotation {\tilde \sigma}$ and $\tilde \sigma = \InverseRotation \sigma$.
        \item
            \label{item:action_of_Euclidean_derivative}
            If $X \in \LieAlgebra \cap \VectorSpace$, then
            \begin{align*}
                \LeftDifferentialOperatorFirstOrder{X} \sigma
                = \Rotation {\LeftDifferentialOperatorFirstOrder{X} \tilde \sigma}
                \quad \text{and} \quad
                \LeftDifferentialOperatorFirstOrder{X} \tilde \sigma
                = \InverseRotation {\LeftDifferentialOperatorFirstOrder{X} \sigma}.
            \end{align*}
        \item
            \label{item:action_of_K-derivative}
            If $Y \in \LieAlgebraCompactGroup$, we have
            \begin{align*}
                \LeftDifferentialOperatorFirstOrder{Y} \sigma(x, k; \lambda)
                &= \Rotation {
                    \LeftDifferentialOperatorFirstOrder{Y} \tilde \sigma
                    + \sum_{j = 1}^{\dim \VectorSpace} (\DifferenceOperator[\VectorSpace]{j} \tilde \sigma) \Rep[\GroupDirect] {k Y k^{-1} \lambda} (\partial_j)
                }(x, k; \lambda)\\
                \LeftDifferentialOperatorFirstOrder Y \tilde \sigma(x, k; \lambda)
                &= \InverseRotation {\LeftDifferentialOperatorFirstOrder Y \sigma
                - \sum_{j = 1}^{\dim \VectorSpace} \DifferenceOperator{j} \sigma \ \Rep \lambda (Y^t X_j)
                }(x, k; \lambda).
            \end{align*}
    \end{enumerate}
\end{lemma}
\begin{proof}
    Let us write $T = \Op (\sigma)$.
    It follows that by
    % TODO: Reference both quantisations
    \begin{align*}
        T \phi(x, k)
        &= \int_{\GroupDirect} \phi(y, l) {\tilde \kappa}_{x, k}(x - y, l^{-1} k) \dd (y, l)\\
        &= \int_{\GroupDirect} \phi(y, l) {\kappa}_{x, k}({(y, l)}^{-1} (x, k)) \dd (y, l)
    \end{align*}
    in the sense of distributions.
    Therefore, it follows that we have
    \begin{align}
        {\tilde \kappa}_{x, k}(x - y, l^{-1} k) =
        {\kappa}_{x, k}({(y, l)}^{-1} (x, k)),
        \label{eq:link_between_the_kernels}
    \end{align}
    again in the sense of distributions.

    \begin{enumerate}
        \item
            Suppose first that $\sigma \in \SmoothingSymbols$ so that its kernel $\kappa_{x, k} \in \Schwartz \Group$.
            By definition, $\DifferenceOperator{q} \sigma(x, k; \lambda)$ is equal to
            \begin{align*}
                &\quad \int_\Group q((y, l)^{-1}) \kappa_{x, k}((y, l)^{-1}) \e^{\i \turn \ip {u^{-1} \lambda} y} \RightRegularRepresentation(l) \dd (y, l)\\
                &= \int_\Group q((y, l)^{-1} (x, k)) \kappa_{x, k}((y, l)^{-1} (x, k))\\
                &\qquad \qquad \e^{\i \turn \ip {u^{-1} \lambda} {k^{-1} (y - x)}} \RightRegularRepresentation(k^{-1} l) \dd (y, l)
            \end{align*}
            where we substituted $(y, l)$ for $(x, k)^{-1} (y, l)$ to obtain the last line.

            Using
            \begin{align*}
                (y, l)^{-1} (x, k) = (l^{-1}(x - y), l^{-1} k)
            \end{align*}
            and~\eqref{eq:link_between_the_kernels},
            if follows that $\DifferenceOperator{q} \sigma(x, k; \lambda)$ becomes
            \begin{align*}
                \int_\Group q(l^{-1}(x - y), l^{-1} k) \tilde \kappa_{x, k}(x - y, l^{-1} k) \e^{\i \turn \ip {k u^{-1} \lambda} {(y - x)}} \RightRegularRepresentation(k^{-1} l) \dd (y, l).
            \end{align*}

            We can now substitute $y$ for $y + x$ and $l$ for $k l$ to obtain that
            \begin{align*}
                &\DifferenceOperator{q} \sigma(x, k; \lambda) F(u) =\\
                &\quad \int_\Group q(-l^{-1} y, l^{-1}) \tilde \kappa_{x, k}(-y, l^{-1}) \e^{\i \turn \ip {k u^{-1} \lambda} y} \RightRegularRepresentation(l) \dd (y, l) F(u)
            \end{align*}
            which we recognise to be exactly $\DifferenceOperator {\tilde q} \tilde \sigma(x, k, k u^{-1} \lambda) F(u)$.
            Therefore, we have shown that
            \begin{align*}
                \DifferenceOperator{q} \sigma(x, k; \lambda) F(u)
                = \DifferenceOperator {\tilde q} \tilde \sigma(x, k, k u^{-1} \lambda) F(u),
            \end{align*}
            or in other words $\DifferenceOperator q \sigma = \Rotation {\DifferenceOperator[\GroupDirect] {\tilde q} \tilde \sigma}$.

            The other identity is proven by observing that $\InverseRotation \dummy$ is the inverse of $\Rotation \dummy$.
        \item
            This identity follows easily from the previous point.
        \item
            Applying $\LeftDifferentialOperatorFirstOrder Y$ on both sides of $\sigma = \Rotation {\tilde \sigma}$,
            we obtain
            \begin{align}
                \LeftDifferentialOperatorFirstOrder Y_k \sigma(x, k; \lambda)
                &= \LeftDifferentialOperatorFirstOrder Y_{k' = k} \tilde \sigma(x, k'; k u^{-1} \lambda) + \LeftDifferentialOperatorFirstOrder Y_{k' = k} \tilde \sigma(x, k; k' u^{-1} \lambda)\\
                &= \Rotation {\LeftDifferentialOperatorFirstOrder Y \tilde \sigma}(x, k; \lambda) + \LeftDifferentialOperatorFirstOrder Y_{k' = k} \tilde \sigma(x, k; k' u^{-1} \lambda).
                \label{eq:Y_derivative_of_rotated_symbol_on_direct_product}
            \end{align}

            The second term on the right-hand side can be computed via Lemma \ref{lemma:Y_derivative_on_lambda_variable_of_symbols} to be
            \begin{align*}
                \LeftDifferentialOperatorFirstOrder Y_{k' = k} \tilde \sigma(x, k; k' u^{-1} \lambda)
                &= \sum_{j = 1}^{\dim \VectorSpace} \DifferenceOperator[\VectorSpace]{j} \tilde \sigma(x, k; k u^{-1} \lambda) \Rep[\GroupDirect]{k Y u^{-1} \lambda} (\partial_j)\\
                &= \sum_{j = 1}^{\dim \VectorSpace} \DifferenceOperator[\VectorSpace]{j} \tilde \sigma(x, k; k u^{-1} \lambda) \Rep[\GroupDirect]{k Y k^{-1} (k u^{-1} \lambda)} (\partial_j)\\
                &= \sum_{j = 1}^{\dim \VectorSpace} \Rotation {\DifferenceOperator[\VectorSpace]{j} \tilde \sigma} (x, k; \lambda) \Rotation {\Rep[\GroupDirect]{k Y k^{-1} \lambda} (\partial_j)}.
            \end{align*}

            Plugging the above into \eqref{eq:Y_derivative_of_rotated_symbol_on_direct_product}, we obtain
            \begin{align*}
                \LeftDifferentialOperatorFirstOrder Y \sigma(x, k; \lambda)
                &= \Rotation {\LeftDifferentialOperatorFirstOrder Y \tilde \sigma}(x, k; \lambda)
                + \sum_{j = 1}^{\dim \VectorSpace} \Rotation {\DifferenceOperator[\VectorSpace]{j} \tilde \sigma \ \Rep[\GroupDirect]{k Y k^{-1} \lambda} (\partial_j)}(x, k; \lambda)\\
                &= \Rotation {\LeftDifferentialOperatorFirstOrder Y \tilde \sigma
                    + \sum_{j = 1}^{\dim \VectorSpace} \DifferenceOperator[\VectorSpace]{j} \tilde \sigma \ \Rep[\GroupDirect]{k Y k^{-1} \lambda} (\partial_j)
                }(x, k; \lambda),
            \end{align*}
            which is what we wanted to show.

            To show the second identity,
            we apply $\LeftDifferentialOperatorFirstOrder Y$ on both sides of $\tilde \sigma = \InverseRotation {\sigma}$ to obtain
            \begin{align*}
                \LeftDifferentialOperatorFirstOrder Y_k \tilde \sigma(x, k; \lambda)
                = \LeftDifferentialOperatorFirstOrder Y_{k' = k} \sigma(x, k'; u k^{-1} \lambda) + \LeftDifferentialOperatorFirstOrder Y_{k' = k} \sigma(x, k; u {k'}^{-1} \lambda) \notag\\
                = \InverseRotation {\LeftDifferentialOperatorFirstOrder Y \sigma}(x, k; \lambda) - \LeftDifferentialOperatorFirstOrder Y_{u} \tilde \sigma(x, k; u k^{-1} \lambda).
                \label{eq:Y_derivative_of_rotated_symbol_on_semi-direct_product}
            \end{align*}

            Using Lemma~\ref{lemma:Y_derivative_on_lambda_variable_of_symbols} again to compute the second term of the right-hand side,
            \begin{align*}
                \LeftDifferentialOperatorFirstOrder Y_u \tilde \sigma(x, k; u k^{-1} \lambda)
                &= \sum_{j = 1}^{\dim \VectorSpace} \DifferenceOperator{j} \sigma (x, k; u k^{-1} \lambda) \Rep {u Y k \lambda} (X_j)\\
                &= \sum_{j = 1}^{\dim \VectorSpace} \DifferenceOperator{j} \sigma (x, k; u k^{-1} \lambda) \Rep {u Y u^{-1} u k \lambda} (X_j)\\
                &= \sum_{j = 1}^{\dim \VectorSpace} \InverseRotation {\DifferenceOperator{j} \sigma \Rep {u Y u^{-1} \lambda} (X_j)}.
            \end{align*}

            Observing that in the above,
            \begin{align*}
                \Rep {u Y u^{-1} \lambda} (X_j)
                = \i \turn \ip {u Y u^{-1} \lambda} {u X_j}
                = \i \turn \ip {\lambda} {u Y^t X_j}
                = \Rep \lambda (Y^t X_j)
            \end{align*}
            so that \eqref{eq:Y_derivative_of_rotated_symbol_on_direct_product} becomes
            \begin{align*}
                \LeftDifferentialOperatorFirstOrder Y_k \tilde \sigma(x, k; \lambda)
                = \InverseRotation {\LeftDifferentialOperatorFirstOrder Y \sigma
                - \sum_{j = 1}^{\dim \VectorSpace} \DifferenceOperator{j} \sigma \ \Rep \lambda (Y^t X_j)
                }(x, k; \lambda),
            \end{align*}
            concluding the proof.
    \end{enumerate}
\end{proof}

\begin{lemma}
\label{lemma:inclusion_in_zero_class}
    Let $m \defeq \frac {-\dim \CompactGroup} 2 (1 - \rho)$.
    % TODO: Can we prove the result for $m = 0$ or improve?
    \begin{enumerate}
        \item
            If $\sigma \in \SymbolClass m {\rho, \delta}$,
            then $\tilde \sigma = \InverseRotation \sigma$ satisfies
            \begin{align*}
                \sup_{(x, k) \in \Group} \esssup_{\lambda \in \VectorSpace}
                \norm [\Lin {\Lebesgue 2 \CompactGroup}] {\tilde \sigma(x, k; \lambda)} < \infty.
            \end{align*}
        \item
            If $\tilde \sigma \in \SymbolClass [\GroupDirect] m {\rho, \delta}$,
            then $\sigma = \Rotation {\tilde \sigma}$ satisfies
            \begin{align*}
                \sup_{(x, k) \in \Group} \esssup_{\lambda \in \VectorSpace}
                \norm [\Lin {\Lebesgue 2 \CompactGroup}] {\sigma(x, k; \lambda)} < \infty.
            \end{align*}
    \end{enumerate}
\end{lemma}
\begin{proof}
    Let $F \in \Lebesgue 2 \CompactGroup$ and $u \in \CompactGroup$.
    By the Sobolev Inequality,
    we know that
    \begin{align*}
        \int_\CompactGroup \sup_{v \in \CompactGroup} \abs {\sigma(x, k; v \lambda) F(u)}^2 \dd u
        \leq C \sum_{\beta} \int_\CompactGroup \int_\CompactGroup \abs{Y^\beta_v \sigma(x, k; v \lambda) F(u)}^2 \dd v \dd u
    \end{align*}
    Using Lemma~\ref{lemma:Y_derivative_on_lambda_variable_of_symbols},
    we know that each $Y^\beta_v \sigma \in \SymbolClass {m + \abs \beta (1 - \rho)} {\rho, \delta} \subset \SymbolClass 0 {\rho, \delta}$ so that the above becomes
    \begin{align*}
        \sup_{(x, k) \in \Group} \esssup_{\lambda \in \VectorSpace}
        \int_\CompactGroup \sup_{v \in \CompactGroup} \abs {\sigma(x, k; v \lambda) F(u)}^2 \dd u
        \leq C \norm [\Lebesgue 2 \CompactGroup] {F}^2.
    \end{align*}

    From the above inequality, we easily derive that
    \begin{align*}
        \sup_{(x, k) \in \Group}& \esssup_{\lambda \in \VectorSpace} \norm [\Lebesgue 2 \CompactGroup] {\tilde \sigma(x, k; \lambda) F}^2\\
        &= \sup_{(x, k) \in \Group} \esssup_{\lambda \in \VectorSpace} \int_\CompactGroup \abs {\sigma(x, k; u k^{-1} \lambda) F(u)}^2 \dd u\\
        &\leq \sup_{(x, k) \in \Group} \esssup_{\lambda \in \VectorSpace} \int_\CompactGroup \sup_{v \in \CompactGroup} \abs {\sigma(x, k; v \lambda) F(u)}^2 \dd u\\
        &\leq C \norm [\Lebesgue 2 \CompactGroup] {F}^2,
    \end{align*}
    which concludes the proof.

    The second bound is obtained with an identical argument.
\end{proof}

\begin{theorem}
    Let $\delta' = \max \{\delta, 1 - \rho\}$ and $m' = m + \frac {\dim \CompactGroup} 2 (1 - \rho)$.

    \begin{enumerate}
        \item
            For each $\sigma \in \SymbolClass m {\rho, \delta}$,
            the symbol $\tilde \sigma = \InverseRotation \sigma$ belongs to $\SymbolClass [\GroupDirect] {m'} {\rho, \delta'}$
            and satisfies
            \begin{align*}
                \Op[\Group] (\sigma) = \Op[\GroupDirect] (\tilde \sigma).
            \end{align*}
        \item
            Reciprocally, for each $\tilde \sigma \in \SymbolClass [\GroupDirect] m {\rho, \delta}$,
            the symbol $\sigma = \Rotation {\tilde \sigma}$ belongs to $\SymbolClass {m'} {\rho, \delta'}$
            and satisfies
            \begin{align*}
                \Op[\GroupDirect] (\tilde \sigma) = \Op[\Group] (\sigma).
            \end{align*}
    \end{enumerate}

    In particular, if $\rho = 1$, the symbol classes coincide
    \begin{align*}
        \SymbolClass m {1, \delta} = \SymbolClass [\GroupDirect] m {1, \delta}.
    \end{align*}
\end{theorem}
\begin{proof}
    Let us prove the first claim,
    as the proof of the second uses an identical argument.

    Let $\sigma \in \SymbolClass m {\rho, \delta}$,
    and write $\tilde \sigma \defeq \InverseRotation \sigma$.

    \begin{claim}
        Given $\tilde{q} \in \CompactGroup$ and $\beta \in \N^{\dim \Group}$,
        there exists a symbol $\tau \in \SymbolClass {m - \rho \order(q) + \delta' \abs \beta} {\rho, \delta'}$ such that
        \begin{align*}
            \DifferenceOperator [\GroupDirect] {\tilde q} X^\beta \tilde \sigma = \InverseRotation \tau.
        \end{align*}
    \end{claim}
    \begin{proof}[Proof of the claim]
        Let us prove the claim by induction on $\abs \beta$.
        The initial case $\beta = 0$ follows easily from Lemma~\ref{lemma:link_between_symbols} (\ref{item:action_of_difference_operators})
        and the inclusion
        \begin{align*}
            \SymbolClass {m - \rho \order(q)} {\rho, \delta} \subset \SymbolClass {m - \rho \order(q)} {\rho, \delta'}.
        \end{align*}

        Now, let us assume the claim holds for a certain $\beta$,
        so that there exists $\tau \in \SymbolClass {m - \rho \order(q) + \delta' \abs \beta} {\rho, \delta'}$ such that
        \begin{align*}
            \DifferenceOperator [\GroupDirect] {\tilde q} X^\beta \tilde \sigma = \InverseRotation \tau.
        \end{align*}

        If $X \in \LieAlgebra \cap \VectorSpace$,
        then by (\ref{item:action_of_Euclidean_derivative}) of Lemma~\ref{lemma:link_between_symbols} we have
        \begin{align*}
            \DifferenceOperator [\GroupDirect] {\tilde q} X X^\beta \tilde \sigma = \InverseRotation {X \tau},
        \end{align*}
        where $X \tau \in \SymbolClass {m - \rho \order(q) + \delta' (\abs \beta + 1)} {\rho, \delta'}$.

        If $X \in \LieAlgebraCompactGroup$,
        then by (\ref{item:action_of_K-derivative}) of Lemma~\ref{lemma:link_between_symbols} we have
        \begin{align*}
            \DifferenceOperator [\GroupDirect] {\tilde q} X X^\beta \tilde \sigma = \InverseRotation {X \tau - \sum_{j = 1}^{\dim \VectorSpace} \DifferenceOperator{j} \tau \ \Rep {\lambda} (X^t X_j) }
        \end{align*}
        where $X \tau - \sum_{j = 1}^{\dim \VectorSpace} \DifferenceOperator{j} \tau \ \Rep {\lambda} (X^t X_j) \in \SymbolClass {m - \rho \order(q) + \delta' (\abs \beta + 1)} {\rho, \delta'}$.
        To see this,
        we observe the condition $\delta' \geq 1 - \rho$ implies that $X \tau$ is the term with higher order.

        Either way, this concludes the induction, and thus the proof of the claim.
    \end{proof}

    By our claim,
    there exists a symbol $\tau \in \SymbolClass {m - \rho \order(q) + \delta' \abs \beta} {\rho, \delta'}$ such that
    \begin{align*}
        \DifferenceOperator [\GroupDirect] {\tilde q} X^\beta \tilde \sigma = \InverseRotation \tau.
    \end{align*}

    Note that the above implies that
    \begin{align*}
        \Rep[\GroupDirect] \lambda \BesselPotential{-m' + \rho \order(q) - \delta' \abs \beta + \gamma} \DifferenceOperator [\GroupDirect] {\tilde q} X^\beta \tilde \sigma(x, k; \lambda) \Rep [\GroupDirect] \lambda \BesselPotential{-\gamma}\\
        = \InverseRotation {\Rep \lambda \BesselPotential{-m' + \rho \order(q) - \delta' \abs \beta + \gamma} \tau \Rep \lambda \BesselPotential{-\gamma}} (x, k; \lambda).
    \end{align*}

    Since the operator inside $\InverseRotation \dummy$ on the second line belongs to
    \begin{align*}
        \SymbolClass {-\frac {\dim \CompactGroup} 2 (1 - \rho) } {\rho, \delta'},
    \end{align*}
    then Lemma~\ref{lemma:inclusion_in_zero_class} implies that
    \begin{align*}
        &\sup_{g \in \GroupDirect} \esssup_{\lambda \in \VectorSpace}\\
        &\quad
        \norm [\Lin {\Lebesgue 2 \CompactGroup}] {%
            \Rep[\GroupDirect] \lambda \BesselPotential{-m' + \rho \abs \alpha  - \delta' \abs \beta} \DifferenceOperator [\GroupDirect] {\tilde q} X^\beta \tilde \sigma(x, k; \lambda) \Rep [\GroupDirect] \lambda
        }
        % TODO: show the direct product doesn't require the gamma trick
    \end{align*}
    is finite,
    which by definition means that $\tilde \sigma \in \SymbolClass [\GroupDirect] {m'} {\rho, \delta'}$.
\end{proof}

\section{Littlewood-Paley decomposition}

\begin{lemma}
\label{lemma:derivatives_of_radial_functions}
    Let $\alpha \in \N^n$,
    and fix a radial function $\chi \in \SmoothFunctions{\R^n}$.
    If $\alpha \in \N^n$, then
    \begin{align}
        \D{\abs \alpha}[\chi]{x^\alpha}(x)
        = \sum_{r = 1}^{C_\alpha} f_r(\norm[\R^n]{x}) P_r(x),
    \end{align}
    where $P_r$ is a polynomial depending only on $\alpha$.

    Moreover, if $\supp \chi$ is compact
    and if there exists $\delta > 0$ such that the radial derivative $\D{\abs \alpha}[\chi]{\lambda}$ vanishes on on $\Ball[\R^n]{0}{\delta}$,
    then we have
    \begin{align*}
        \sup_r \sup_{\lambda \in \R^+} \abs{f_r} < \infty
    \end{align*}
\end{lemma}
\begin{proof}
    Using the chain rule, we know that for a purely radial function $f$
    \begin{align}
        \D{1}[f]{{x_i} } = \D{1}[\lambda]{{x_i} } \D{1}[f]{\lambda} = \frac{\D{1}[f]{\lambda}}{\norm[\R^n]{x}} x_i.
    \end{align}

    We know proceed to show the claim by induction on $\alpha$.
    The result is clearly true when $\abs{\alpha} = 0$.
    If we assume it is true for some $\alpha \in \N^n$, then by the above,
    \begin{align}
        \D{\abs \alpha + 1}[\chi]{{x_i} , x^\alpha}(x)
        &= \D{1}{{x_i} } \sum_{r = 1}^{C_\alpha} f_r(\norm[\R^n]{x}) P_r(x)\\
        &= \sum_{r = 1}^{C_\alpha} \frac{\D{1}[f_r]{\lambda}}{\norm[\R^n]{x}}(\norm[\R^n]{x}) x_i P_r(x)
        + \sum_{r = 1}^{C_\alpha} f_r(\norm[\R^n]{x}) \D{1}[P_r]{{x_i} }(x),
    \end{align}
    which concludes the proof.
\end{proof}

\begin{lemma}
\label{lemma:left_regular_representation_of_polynomials}
    Let $P \in \SmoothFunctions{\dualGroup{\VectorSpace}}$ be a polynomial.
    We can find functions $q_i \in \Polynomials{\CompactGroup}$, $f_i \in \Lebesgue{2}{\dualGroup{\VectorSpace}}$, $i = 1, \dots, N$ such that
    \begin{align*}
        P(k \lambda) = \sum_{i = 1}^N q_i(k) f_i(\lambda)
    \end{align*}
    for each $k \in \CompactGroup$ and each $\lambda \in \dualGroup{\VectorSpace}$.

    Moreover, the $q_i$ satisfy the bound
    \begin{align*}
        \sup_i \sup_\CompactGroup \abs{q_i} < \infty.
    \end{align*}
\end{lemma}

\begin{theorem}[Littlewood-Paley decomposition]
\label{theorem:Littlewood-Paley_decomposition}
\index{Littlewood-Paley decomposition}
    Let $\AbelianGroup$ be a \emph{locally compact abelian Lie group},
    and suppose that $\CompactGroup \subset \Aut(\AbelianGroup)$ is \emph{compact}.

    We now consider the group $\Group = \AbelianGroup \ltimes \CompactGroup$.

    Suppose further that the following conditions are satisfied.
    \begin{enumerate}
        \item The Haar measure of $\AbelianGroup$ is invariant under $\CompactGroup$,
            i.e.\ for each $f \in \Lebesgue{1}{\Group}$ and each $k \in \CompactGroup$, we have
            \begin{align*}
                \int_\AbelianGroup f(a) \dd a = \int_\AbelianGroup f(k a) \dd a.
            \end{align*}
        \item The Laplacian on $\AbelianGroup$ is invariant under $\CompactGroup$,
            i.e.\ for every $\phi \in \Schwartz\AbelianGroup$ and every $k \in \CompactGroup$, we have
            \begin{align*}
                (\Laplacian[\AbelianGroup] \phi(k \dummy))(a)
                = (\Laplacian[\AbelianGroup] \phi)(k a).
            \end{align*}
        \item There exists a Littlewood-Paley decomposition on $\AbelianGroup$ invariant under $\CompactGroup$,
            i.e.\ a sequence $\chi_j \in \Fourier(\Schwartz\AbelianGroup), j \in \N$ such that:
            \begin{enumerate}
                \item they sum to 1, i.e.\ we have $\sum_{j = 0}^\infty \chi_j = 1$.
                \item the functions $\chi_j$, $j \in \N$, are invariant under $\CompactGroup$:
                    for each $\lambda \in \dualGroup\AbelianGroup$ and each $k \in \CompactGroup$, we have $\chi_j(k \lambda) = \chi_j(\lambda)$.
                \item There exists $C > 0$ such that for every $j \in \N$, we have
                    \begin{align*}
                        \chi_j(\lambda) = 0 \quad \text{if} \quad \JapaneseBracket{\AbelianGroup}{\lambda} \geq C 2^j.
                    \end{align*}
                \item for each $q \in \Polynomials\AbelianGroup$,
                    there exists a finite family $q_1, \dots, q_{C_q} \in \Polynomials\CompactGroup$ such that
                    \begin{align*}
                        q(k a) = \sum_{r = 1}^{C_q} f_r(a) q_j(k)
                    \end{align*}
                    for some bounded functions $f_r : A \to \C$, $r \in \{1, \dots, C_q\}$.
            \end{enumerate}
    \end{enumerate}

    If all the above conditions hold,
    there exists a sequence $\eta_l \in \SmoothingSymbols$, $l \in \N$ of smoothing symbols satisfying the following properties
    \begin{enumerate}
        \item the semi-norms decay in the following way
            \begin{align}
                \SymbolSemiNorm{m}{\rho, \delta}{\eta_l} \leq C 2^{-lm}
            \end{align}
        \item the associated kernels $\kappa_l$ satisfy
            \begin{align*}
                \sum_{l = 0}^\infty \kappa_l = \DiracDelta{e_\Group}
            \end{align*}
            in the sense of distributions.
    \end{enumerate}
\end{theorem}
\begin{proof}
    \begin{description}
        \item[Step 1] Constructing the dyadic decomposition.

            First, let us find a smooth function $\chi_0 \in \SmoothFunctions{\dualGroup{\VectorSpace}}$ invariant under $\CompactGroup$ such that
            \begin{align*}
                \chi_0(\lambda) = 1 \  \text{if}\  \norm[\dualGroup{\VectorSpace}]{\lambda} \leq 1, \quad \text{and} \quad
                \chi_0(\lambda) \equiv 0 \ \text{if}\  \norm[\dualGroup{\VectorSpace}]{\lambda} \geq 2.
            \end{align*}

            Then, for each $l \in \N$ satisfying $l \geq 1$, let
            \begin{align*}
                \chi_l = \chi_0(2^{-l} \dummy) - \chi_0(2^{-l + 1} \dummy).
            \end{align*}
            so that $\supp \chi_l \subset \Ball{0}{2^{l + 1}}$.

            In particular, it should be clear that
            \begin{align*}
                \sum_{l = 0}^N \chi_l = \chi_0(2^{-N} \dummy)
            \end{align*}
            so that in fact
            \begin{align}
                \sum_{l = 0}^\infty \chi_l = 1.
                \label{eq:theorem:Littlewood-Paley_decomposition:partition_of_unity}
            \end{align}

            Fix $l \in \N$.
            We define our symbol $\eta_l$ as follows.
            For each $\tau \in \dualGroup{\CompactGroup}$, we let
            \begin{align*}
                \eta_l(\lambda)
                = \sum_{\JapaneseBracket{\CompactGroup}{\tau} \leq 2^l}
                \chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}}(\lambda) \Id{V_\tau},
            \end{align*}
            where $V_\tau = \Span \{ \tau_{ij} : i, j = 1, \dots, \dimRep{\tau} \}$.

            Note that since $\supp \chi_l \subset \Ball{0}{2^{l + 1}}$,
            we get that
            \begin{align}
                \eta_l(\lambda) = 0 \quad \text{if } \norm[\dualGroup{\CompactGroup}]{v} \geq 2^{l + 1}
                \label{eq:theorem:Littlewood-Paley_decomposition:cancellation_condition}
            \end{align}

            We check that
            \begin{align*}
                \sum_{l = 0}^\infty \eta_l
                &= \sum_{l = 0}^\infty
                    \sum_{\JapaneseBracket{\CompactGroup}{\tau} \leq 2^l}
                        \chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}} \Id{V_\tau}\\
                &= \sum_{\tau \in \dualGroup{\CompactGroup}}
                    \sum_{l = \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}}^\infty
                        \chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}} \Id{V_\tau},
            \end{align*}
            where the last line was obtained by commuting the two sums.

            Substituing $l$ for $l + \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}$ in the inner sum,
            the above becomes
            \begin{align*}
                \sum_{l = 0}^\infty \eta_l
                = \sum_{\tau \in \dualGroup{\CompactGroup}}
                    \sum_{l = 0}^\infty
                        \chi_l \Id{V_\tau}
                = \sum_{\tau \in \dualGroup{\CompactGroup}}
                    \Id{V_\tau}
                = \Id{\Lebesgue{2}{\CompactGroup}},
            \end{align*}
            where the second to last inequality was obtained from~\eqref{eq:theorem:Littlewood-Paley_decomposition:partition_of_unity}.

        \item[Step 2] Computing the associated kernels $\kappa_l$.

            By applying the inverse Fourier Transform (Proposition~\ref{proposition:inverse_Fourier_Transform})
            we obtain that the kernel is given by
            \begin{align}
                \kappa_l(x, k)
                = \sum_{\JapaneseBracket{\CompactGroup}{\tau} \leq 2^l}
                    \int_\dualGroup{\VectorSpace}
                        \chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}}(\lambda) \tr( \left. \Rep{\lambda}(x, k) \right|_{V_\tau} )
                    \dd \Plancherel{\VectorSpace}(\lambda)
                \label{eq:theorem:Littlewood-Paley_decomposition:computing_kernel}
            \end{align}

            By the Peter-Weyl Theorem,
            $\{ \sqrt{\dimRep{\tau}} \tau_{pq} : p, q = 1, \dots, \dimRep{\tau} \}$
            is an orthonormal basis of $V_\tau$,
            allowing us to compute the trace as
            \begin{align*}
                \tr( \left. \Rep{\lambda}(x, k) \right|_{V_\tau})
                &= \sum_{p = 1}^\dimRep{\tau}
                    \dimRep{\tau}
                    \int_\Lebesgue{2}{\CompactGroup}
                    (u \lambda)(x) \tau_{pp}(k^{-1} u) \conj{\tau_{pp}(u)}
                    \dd u\\
                &= \sum_{p,q = 1}^\dimRep{\tau}
                    \dimRep{\tau}
                    \int_\Lebesgue{2}{\CompactGroup}
                        (u \lambda)(x) \tau_{pq}(k^{-1}) \tau_{q p}(u) \conj{\tau_{pp}(u)}
                    \dd u.
            \end{align*}

            Using the above in~\eqref{eq:theorem:Littlewood-Paley_decomposition:computing_kernel},
            and substituing $\lambda$ for $u^{-1} \lambda$,
            we obtain
            \begin{align}
                \kappa_l (x, k)
                = &\sum_{\JapaneseBracket{\CompactGroup}{\tau} \leq 2^l}
                        \sum_{p,q = 1}^\dimRep{\tau}
                        \dimRep{\tau}
                        \int_\dualGroup{\VectorSpace}
                                \int_\Lebesgue{2}{\CompactGroup} \notag\\
                                    &\chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}}(u^{-1}\lambda) \lambda(x) \tau_{pq}(k^{-1}) \tau_{qp}(u) \conj{\tau_{pp}(u)}
                                \dd u
                            \dd \Plancherel{\VectorSpace}(\lambda)
                    \label{eq:theorem:Littlewood-Paley_decomposition:computing_kernel:2}
            \end{align}

            Using the invariance of $\chi_{k}$ under $\CompactGroup$ and
            \begin{align*}
                \dimRep{\tau} \int_\Lebesgue{2}{\CompactGroup} \tau_{qp}(u) \conj{\tau_{pp}(u)} \dd u = \Kronecker{p}{q},
            \end{align*}
            then~\eqref{eq:theorem:Littlewood-Paley_decomposition:computing_kernel:2} becomes
            \begin{align*}
                \kappa_l (x, k)
                = &\sum_{\JapaneseBracket{\CompactGroup}{\tau} \leq 2^l}
                    \int_\dualGroup{\VectorSpace}
                        \chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}}(\lambda) \lambda(x)
                    \dd \Plancherel{\VectorSpace}(\lambda)
                    \conj{\Character{\tau}(k)}
            \end{align*}
            which, after recognising the inverse Fourier Transform on $\dualGroup{\VectorSpace}$,
            yields the following expression for the kernel
            \begin{align}
                \kappa_l (x, k)
                = &\sum_{\JapaneseBracket{\CompactGroup}{\tau} \leq 2^l}
                    \InverseFourier[\VectorSpace]{\chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}}}(x) \conj{\Character{\tau}(k)}.
                \label{eq:theorem:Littlewood-Paley_decomposition:kernel}
            \end{align}

        \item[Step 3] We show that for every $q \in \Polynomials{\Group}$
            and every $\lambda \in \dualGroup{\VectorSpace}$,
            \begin{align}
                \sup_{l \in \N} \norm[\Lin{\Lebesgue{2}{\CompactGroup}}]{\DifferenceOperator{q} \eta_l(\lambda)} < \infty.
            \end{align}

            Fix $q_1 \in \Polynomials{\VectorSpace}$, $q_2 \in \Polynomials{\CompactGroup}$
            and write $q(x, k) = q_1(x) q_2(k)$.
            We also choose an arbitrary function $F \in \Lebesgue{2}{\CompactGroup}$,
            and an element $u \in \CompactGroup$.

            Informally, the idea behind the proof of this step is the following
            if we can write
            \begin{align*}
                \DifferenceOperator{q} \eta_l(\lambda) F(u)
                = \sum_{\tau \in \dualGroup{\CompactGroup}}
                    \dimRep{\tau}
                    \tr\left( \tau(u) \sigma_{l, \lambda, q, \lambda}(u, \tau) \Fourier[\CompactGroup] F(\tau) \right),
            \end{align*}
            then a bound on the operator norm of $\DifferenceOperator{q} \eta_l (\lambda)$ can be obtained by finding an appropriate bound on $\sigma_{l, q, \lambda}$.
            Looking at~\eqref{eq:theorem:Littlewood-Paley_decomposition:kernel},
            we can see the latter is the right approach
            as we have a sum on $\dualGroup{\CompactGroup}$ already.

            Multiplying $\kappa_l$ par $q$ and taking the Fourier Transform, we get
            \begin{align}
                \DifferenceOperator{q} \eta_l (\lambda) F(u)
                = &\sum_{\JapaneseBracket{\CompactGroup}{\tau} \leq 2^l}
                    \int_\VectorSpace
                        \int_\CompactGroup
                            q_1(x) \InverseFourier[\VectorSpace]{\chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}}}(x) (k u \lambda)(-x) \notag\\
                            &\quad q_2(k) \conj{\Character{\tau}(k)} F(k u)
                        \dd k
                    \dd x\notag\\
                = &\sum_{\JapaneseBracket{\CompactGroup}{\tau} \leq 2^l}
                    \int_\CompactGroup
                        \DifferenceOperator[\VectorSpace]{q_1} \chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}}(k u \lambda)
                        q_2(k) \conj{\Character{\tau}(k)} F(k u)
                    \dd k \label{eq:theorem:Littlewood-Paley_decomposition:rho_condition},
            \end{align}
            where the second line was obtained by integrating with respect to $x$.

            Substituing $k$ for $k u^{-1}$ in the above,
            and using the Leibniz rule for polynomials on $q_2$, we obtain
            \begin{align*}
                \DifferenceOperator{q} \eta_l (\lambda) F(u)
                = &\sum_{\JapaneseBracket{\CompactGroup}{\tau} \leq 2^l}
                    \sum_{p = 1}^{C_q}
                        \int_\CompactGroup
                            \DifferenceOperator[\VectorSpace]{q_1} \chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}}(k \lambda)\\
                            &\quad q_{2, p}(k) {q'}_{2, p}(u^{-1}) \conj{\Character{\tau}(k u^{-1})} F(k)
                        \dd k,
            \end{align*}

            \begin{claim}
                We have the decomposition
                \begin{align*}
                    \DifferenceOperator[\VectorSpace]{q_1} \chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}}(k \lambda) = \sum_{r = 1}^{C_q} f_{l, r}(\tau, \lambda) q_r(k),
                \end{align*}
                where $q_r$ and $f_{l, r}$ satisfies the following bound
                \begin{align}
                    \sup_{l \in \N} \sup_{\tau \in \dualGroup{\CompactGroup}} \sup_{\lambda \in \dualGroup{\VectorSpace}} \abs{f_{l, r}(\tau, \lambda)} < \infty,\quad
                    \sup_{r} \sup_{k \in \CompactGroup} \abs{q(k)} < \infty
                    \label{eq:theorem:Littlewood-Paley_decomposition:claim_bound}
                \end{align}
            \end{claim}
            \begin{proof}[Proof of the claim]
                Assume first that $l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}} \neq 0$.
                Since
                \begin{align*}
                    \chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}}(\lambda)
                    = \chi_1(2^{-l + \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau} + 1}} \lambda),
                \end{align*}
                it follows that
                \begin{align*}
                    \DifferenceOperator[\VectorSpace]{q_1} &\chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}}(k \lambda)
                    =\\
                    &\qquad 2^{(-l + \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau} + 1}) \order{q_1}}
                    \DifferenceOperator[\VectorSpace]{q_1} \chi_1(2^{-l + \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau} + 1}} k \lambda).
                \end{align*}

                Using Lemma~\ref{lemma:derivatives_of_radial_functions} and Lemma~\ref{lemma:left_regular_representation_of_polynomials}
                we obtain
                \begin{align*}
                    \DifferenceOperator[\VectorSpace]{q_1} &\chi_{l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}}}(k \lambda) =
                    2^{(-l + \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau} + 1}) \order{q_1}}\\
                    &\sum_{r = 1}^{C_q} f_r(2^{-l + \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau} + 1}} \norm[\dualGroup{\VectorSpace}]{\lambda}) q_r(k) P_r(2^{-l + \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau} + 1}} \lambda),
                \end{align*}
                where each $f_r$, $q_r$ and each $P_r$ is independent of $l$ and $\tau$.
                Now, writing
                \begin{align*}
                    f_{l, r}(\tau, \lambda) =
                    &2^{(-l + \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau} + 1}) \order{q_1}}\\
                    &f_r(2^{-l + \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau} + 1}} \norm[\dualGroup{\VectorSpace}]{\lambda}) P_r(2^{-l + \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau} + 1}} \lambda),
                \end{align*}
                we obtain the desired formula.
                The bound comes from the bounds in Lemma~\ref{lemma:derivatives_of_radial_functions} and~\ref{lemma:left_regular_representation_of_polynomials}.

                The case $l - \Ceiling{\log_2 \JapaneseBracket{\CompactGroup}{\tau}} = 0$ can be treated similarly.
            \end{proof}

            Using the above claim,
            and the identity
            \begin{align*}
                \conj{\Character{\tau}(k u^{-1})} = \sum_{i, j = 1}^\dimRep{\tau} \tau_{ij}(u) \conj{{\tau_{ij}(k)}},
            \end{align*}
            we observe that
            \begin{align}
                \DifferenceOperator{q} \eta_l (\lambda) F(u)
                = &\sum_{p, r = 1}^{C_q}
                    \sum_{\JapaneseBracket{\CompactGroup}{\tau} \leq 2^l}
                        \sum_{i, j = 1}^\dimRep{\tau}\notag
                            \tau_{ij}(u) {q'}_{2, p}(u^{-1})\\
                            &\quad f_{l, r}(\tau, \lambda)
                            \int_\CompactGroup
                                q_{r}(k) q_{2, p}(k) F(k) \conj{\tau_{ij}(k)}
                            \dd k
                            \label{eq:theorem:Littlewood-Paley_decomposition:exact_expression_for_operator}\\
                = &\sum_{p, r = 1}^{C_q}
                    \sum_{\JapaneseBracket{\CompactGroup}{\tau} \leq 2^l}
                        \sum_{i, j = 1}^\dimRep{\tau}
                            \tau_{ij}(u) {q'}_{2, p}(u^{-1})\notag\\
                            &\quad f_{l, r}(\tau, \lambda)
                            \Fourier[\CompactGroup]{} {\left\{ q_{r} q_{2, p} F\right\}}_{j i}(\tau).\notag
            \end{align}

            For $p, r = 1, \dots, \dimRep{\tau}$, defining the symbols
            \begin{align}
                \sigma_{l, \lambda, p, r}(u, \tau) =
                \begin{cases}
                    \frac{1}{\dimRep{\tau}} {q'}_{2, p}(u^{-1}) f_{l, r}(\tau, \lambda) \Id{\dimRep{\tau}} & \text{if } \JapaneseBracket{\CompactGroup}{\tau} \leq 2^l\\
                    0 & \text{otherwise}
                \end{cases}
            \end{align}
            and denoting by $T_{l, \lambda, p, r}$ the corresponding operators,
            we see that in fact,
            \begin{align*}
                \DifferenceOperator{q} \eta_l (\lambda) F(u)
                = &\sum_{p, r = 1}^{C_q}
                    \sum_{\tau \in \dualGroup{\CompactGroup}}
                        \dimRep{\tau}
                        \tr \left(
                            \tau(u)
                            \sigma_{l, \lambda, p, r}(u, \tau)
                            \Fourier[\CompactGroup]{} \left\{ q_r q_{2, p} F\right\}(\tau)
                        \right)\\
                = &\sum_{p, r = 1}^{C_q}
                        T_{l, \lambda, p, r} (q_r q_{2, p} F)(u).
            \end{align*}

            By~\eqref{eq:theorem:Littlewood-Paley_decomposition:claim_bound},
            we obtain
            \begin{align*}
                \norm[\Lin{\Lebesgue{2}{\CompactGroup}}]{T_{l, \lambda, p, r}}
                &\leq C \sup_{\tau \in \dualGroup{\CompactGroup}} \sup_{u \in \CompactGroup} \norm[\Lin{\HilbertRep{\tau}}]{\sigma_{l, \lambda, p, r}(u, \tau)}\\
                &\leq C_q < \infty
            \end{align*}
            From there, it follows that
            \begin{align*}
                \norm[\Lebesgue{2}{\CompactGroup}]{\DifferenceOperator{q} \eta_l (\lambda) F}
                &\leq C_q \sum_{p, r = 1}^{C_q} \norm[\Lebesgue{2}{\CompactGroup}]{q_r q_{2, p} F}
            \end{align*}
            where $C_q$ does not depend on $l$.

            Now, using the fact that
            \begin{align*}
                \sup_\CompactGroup \abs{q_r q_{2, p}} \leq C_q < \infty
            \end{align*}
            in the above, this concludes the step.

        \item[Step 4] $\ip[\Lebesgue{2}{\CompactGroup}]{\DifferenceOperator{q} \eta_l(\lambda) \mu_{mn}}{\nu_{kl}}$ is non-zero
            only if $\norm[\dualGroup{\VectorSpace}]{\lambda}, \JapaneseBracket{\CompactGroup}{\mu}, \JapaneseBracket{\CompactGroup}{\nu} \leq C_q 2^l$.

            Choose $C_q \geq 2$ so that
            \begin{align*}
                q_r q_{2, p}, q'_{2, p}(\dummy^{-1})
            \end{align*}
            can be generated by the representations $\{ \tau \in \dualGroup{\CompactGroup} : \JapaneseBracket{\CompactGroup}{\tau} \leq \frac{C_q}{2} \}$.

            Suppose now that $\max\{\JapaneseBracket{\CompactGroup}{\mu}, \JapaneseBracket{\CompactGroup}{\nu}\} > C_q 2^l$.
            It follows from our choice of $C_q$ that if $\JapaneseBracket{\CompactGroup}{\tau} \leq 2^l$,
            either of the following equations hold
            \begin{align*}
                \int_\CompactGroup q_r(k) q_{2, p}(k) \mu_{mn}(k) \conj{\tau_{ij}(k)} \dd k &= 0\\
                \int_\CompactGroup \tau_{ij}(u) q'_{2, p}(u) \conj{\nu_{mn}(k)} \dd k &= 0.
            \end{align*}

            From~\eqref{eq:theorem:Littlewood-Paley_decomposition:exact_expression_for_operator} with $F = \mu_{mn}$,
            we can see that the above implies
            \begin{align*}
                \ip[\Lebesgue{2}{\CompactGroup}]{\DifferenceOperator{q} \eta_l(\lambda) \mu_{mn}}{\nu_{kl}} = 0.
            \end{align*}

            The condition on $\lambda$ is obvious by~\eqref{eq:theorem:Littlewood-Paley_decomposition:rho_condition}
            keeping in mind that $\supp \chi_k \subset \Ball[\dualGroup{\VectorSpace}]{0}{2^{k + 1}}$.

        \item[Step 5] Conclusion.

            Let
            \begin{align*}
                L_l(\lambda) =
                \begin{cases}
                    {\left. \Rep{\lambda} \BesselPotential{1} \right|}_{\oplus_{\JapaneseBracket{\CompactGroup}{\tau} \leq C_q 2^l} V_\tau}
                    & \text{if } \norm[\dualGroup{\VectorSpace}]{\lambda} \leq C_q 2^l\\
                    0 & \text{otherwise},
                \end{cases}
            \end{align*}
            where $C_q$ is given by Step 4.

            Observe that $L_l(\lambda)$ is a bounded operator in $\Lebesgue{2}{\CompactGroup}$,
            and the operator norm is bounded by $C_q 2^l$ uniformly in $\lambda$.

            By Step 4,
            \begin{align*}
                \Rep{\lambda} \BesselPotential{- m - \order(q) + \gamma}&
                \DifferenceOperator{q} \eta_l(\lambda)
                \Rep{\lambda} \BesselPotential{-\gamma}\\
                &= {L_l(\lambda)}^{-m - \order(q) + \gamma}
                \DifferenceOperator{q} \eta_l(\lambda)
                {L_l(\lambda)}^{-\gamma},
            \end{align*}
            from which it follows that
            \begin{align*}
                \norm[\Lin{\Lebesgue{2}{\CompactGroup}}]{\Rep{\lambda} \BesselPotential{- m - \order(q) + \gamma} \DifferenceOperator{q} \eta_l(\lambda) \Rep{\lambda} \BesselPotential{-\gamma}}
                \leq C_q 2^{-l m},
            \end{align*}
            which is what we wanted to show.
    \end{description}
\end{proof}

\section{Kernel estimates}

\begin{theorem}[Kernel estimates]
\label{theorem:kernel_estimates}
    Let $\sigma \in \SymbolClass{m}{\rho, \delta}$, and denote by $\kappa$ its associated kernel.
    \begin{enumerate}
        \item For every $N \in \N$, there exists $C > 0$ such that for every $g, (y, l) \in \Group$ with $\norm{y} \geq 1$, we have
            \begin{align*}
                \abs{\kappa_g(y, l)} \leq C \norm{y}^{-N}
            \end{align*}
        \item If $\dim \Group + m > 0$, there exists $C > 0$ such that for every $g, (y, l) \in \Group$ with $y \neq 0$, we have
            \begin{align*}
                \abs{\kappa_g(y, l)} \leq C \norm{y}^{- \frac{\dim \Group + m}{\rho}}
            \end{align*}
        \item If $\dim \Group + m = 0$, there exists $C > 0$ such that for every $g, (y, l) \in \Group$ with $y \neq 0$, we have
            \begin{align*}
                \abs{\kappa_g(y, l)} \leq C \log \norm{y}
            \end{align*}
        \item If $\dim \Group + m < 0$, $\kappa_g$ is continuous on $\Group$ and is bounded
            \begin{align*}
                \sup_{g, h \in \Group} \abs{\kappa_g(h)} \leq C < \infty.
            \end{align*}
    \end{enumerate}
\end{theorem}

\section{Adjoint and composition formulas}

\section{\texorpdfstring{$L^2$}{L2} boundedness}

The aim of this section is to prove
that symbols of order $0$ induce bounded operators in $\Lebesgue 2 \Group$
under one of the following conditions

\begin{enumerate}
    \item $\rho > \delta$;
    \item $\rho = \delta = 0$.
\end{enumerate}

These results would naturally generalise to symbols of order $m$ as follows:
if $\sigma \in \SymbolClass m {\rho, \delta}$,
where $\rho, \delta$ satisfy either of the conditions above,
then $\Op(\sigma)$ extends continuously to a continuous operator
\begin{align*}
    \Op(\sigma) : \Sobolev s \to \Sobolev {s - m}
\end{align*}
for every $s \in \R$.

\subsection{The case $\rho > \delta$}

Suppose that $\sigma_T \in \SymbolClass 0 {\rho, \delta}$ for $0 \leq \delta < \rho \leq 1$.
One way of showing that $T \defeq \Op(\sigma_T)$ is bounded would be to find $S \in \OperatorClass 0 {\rho, \delta}$ such that
\begin{align}
    \adj T T = C \Id {\Schwartz \Group} - \adj S S + R,
    \label{eq:L2_boundedness_decomposition}
\end{align}
where $R \in \OperatorClass m {\rho, \delta}$ for some $m < 0$.

It would then follow that
\begin{align*}
    \norm [\Lebesgue 2 \Group] {T \phi}^2
    &= \ip [\Lebesgue 2 \Group] {\adj T T \phi} \phi\\
    &= C \norm [\Lebesgue 2 \Group] {\phi}^2 - \norm [\Lebesgue 2 \Group] {S \phi}^2 + \ip [\Lebesgue 2 \Group] {R \phi} \phi\\
    &\leq C \norm [\Lebesgue 2 \Group] {\phi}^2 + \norm [\Lebesgue 2 \Group] {R \phi} \norm [\Lebesgue 2 \Group] \phi,
\end{align*}
reducing the boundedness of $T$ to that of $R$,
which is much easier to prove.

A sufficient condition to have \eqref{eq:L2_boundedness_decomposition} would be to have
\begin{align*}
    \adj {\sigma_T} \sigma_T = C \Id {\Lebesgue 2 \CompactGroup} - \adj {\sigma_S} \sigma_S,
\end{align*}
on the symbol side,
with $\sigma_S \defeq \Op^{-1}(S)$.
A good candidate for $\sigma_S$ would therefore be
\begin{align}
    \sigma_S \defeq \sqrt{C \Id {\Lebesgue 2 \CompactGroup} - \adj {\sigma_T} \sigma_T}.
    \label{eq:symbol_to_prove_L2_boundedness}
\end{align}

The condition that $S \in \OperatorClass 0 {\rho, \delta}$ is equivalent to showing
that $\sigma_S \in \SymbolClass 0 {\rho, \delta}$.
The crucial part of the proof is therefore to show that~\eqref{eq:symbol_to_prove_L2_boundedness} is a symbol of order $0$.

\begin{lemma}
\label{lemma:inverse_of_square_root_of_a_symbol_of_order_zero}
    Let $\rho, \delta \in \R$ be such that $1 \geq \rho > \delta \geq 0$.
    If $\sigma \in \SymbolClass 0 {\rho, \delta}$ is \emph{positive definite} and \emph{elliptic},
    then the map
    \begin{align*}
        \tilde \sigma(x, k; \lambda)
        \defeq \int_{\Gamma} z^{-\frac 1 2} (\sigma(x, k; \lambda) - z \Id {\Lebesgue 2 \CompactGroup})^{-1} \dd z
        % TODO specify what \gamma is
    \end{align*}
    also belongs to $\SymbolClass 0 {\rho, \delta}$.
\end{lemma}
\begin{proof}
    To shorten the notation,
    we write
    \begin{align*}
        R(z, \sigma)(x, k; \lambda) \defeq (\sigma(x, k; \lambda) - z \Id {\Lebesgue 2 \CompactGroup})^{-1}
    \end{align*}

    Let us now prove the following claim.

    \begin{claim}
        For every $\beta \in \N^{\dim \Group}$, and each $\alpha$
        % TODO: specify set for \alpha
        \begin{align}
            &\norm [\Lin {\Lebesgue 2 \CompactGroup}] {\Rep \lambda \BesselPotential {\rho \abs \alpha - \delta \abs \beta} \LeftDifferentialOperator \beta \DifferenceOperatorOrder \alpha R(z, \sigma)(x, k; \lambda)} \notag\\
            &\qquad \leq C_{\alpha, \beta} (1 + \abs z)^{-1}.
            \label{eq:estimates_on_the_resolvent}
        \end{align}
    \end{claim}
    \begin{proof}[Proof of the claim]
        First let us prove the claim for $\abs \alpha = \abs \beta = 0$.
    \end{proof}

    Using~\eqref{eq:estimates_on_the_resolvent},
    we can show that
    \begin{align*}
        &\norm [\Lin {\Lebesgue 2 \Group}] {\Rep \lambda \BesselPotential {\rho \abs \alpha - \delta \abs \beta} \LeftDifferentialOperator \beta \DifferenceOperatorOrder \alpha \tilde \sigma(x, k; \lambda)}\\
        &\quad \leq C_{\alpha, \beta} \int_\Gamma \abs z^{-\frac 1 2} (1 + \abs z)^{-1} \abs{\dd z} < +\infty,
    \end{align*}
    showing that $\tilde \sigma$ belongs to $\SymbolClass 0 {\rho, \delta}$.
\end{proof}

\begin{corollary}
\label{corollary:square_root_of_a_symbol_of_order_zero}
    Let $\rho, \delta \in \R$ be such that $1 \geq \rho > \delta \geq 0$.
    If $\sigma \in \SymbolClass 0 {\rho, \delta}$ is \emph{positive definite} and \emph{elliptic},
    then its \emph{square root}
    \begin{align*}
        (x, k; \lambda) \in \Group \times \VectorSpace \mapsto \sqrt{\sigma(x, k; \lambda)}
    \end{align*}
    also belongs to $\SymbolClass 0 {\rho, \delta}$.
\end{corollary}
\begin{proof}
    Let $\tilde \sigma$ be the symbol defined in Lemma~\ref{lemma:inverse_of_square_root_of_a_symbol_of_order_zero}.
    By the Helffer-Sjostrand formula,
    % TODO Reference for Helffer-Sjostrand
    we get
    \begin{align*}
        \sqrt{\sigma(x, k; \lambda)} = \tilde \sigma(x, k; \lambda) \sigma(x, k; \lambda),
    \end{align*}
    which must be in $\SymbolClass 0 {\rho, \delta}$,
    since $\tilde \sigma, \sigma \in \SymbolClass 0 {\rho, \delta}$ by Lemma~\ref{lemma:inclusion_in_zero_class}.
\end{proof}

\begin{proposition}[$L^2$ boundedness]
    Let $\rho, \delta \in \R$ be such that $1 \geq \rho > \delta \geq 0$.
    If $\sigma \in \SymbolClass 0 {\rho, \delta}$,
    then its associated operator $T \defeq \Op(\sigma)$ is bounded in $\Lebesgue 2 \Group$,
    i.e.\ we have
    \begin{align*}
        \norm [\Lebesgue 2 \Group] {T \phi} \leq C \norm [\Lebesgue 2 \Group] \phi.
    \end{align*}
    for every $\phi \in \Schwartz \Group$.
\end{proposition}
\begin{proof}
    \begin{description}
        \item[Step 1.] If $\sigma \in \SymbolClass m {\rho, \delta}$ for $m < -1$, then
            \begin{align*}
                \norm [\Lin{\Lebesgue 2 \Group}] {\Op(\sigma)} < \infty.
            \end{align*}
        \item[Step 2.] If $\sigma \in \SymbolClass m {\rho, \delta}$ for $m < 0$, then
            \begin{align*}
                \norm [\Lin{\Lebesgue 2 \Group}] {\Op(\sigma)} < \infty.
            \end{align*}

            Suppose by contradiction that the claim does not hold.
            Therefore, there exists $m < 0$ and $\sigma \in \SymbolClass m {\rho, \delta}$ such that
            $\Op(\sigma)$ is not bounded.
            In particular, for each $n \in \N$,
            \begin{align*}
                (\Op(\sigma) \adj {\Op(\sigma)})^n
            \end{align*}
            is in $\OperatorClass {2 m n} {\rho, \delta}$ and unbounded.
            When $n$ is such that $-2 m n < -1$, this contradicts Step 1.
        \item[Step 3.] Conclusion

            Let $C \geq 0$ be such that
            \begin{align*}
                \sup_{(x, k) \in \Group} \esssup_{\lambda \in \VectorSpace} \norm [\Lebesgue 2 \CompactGroup] {\sigma(x, k; \lambda)} \leq C.
            \end{align*}

            It follows that
            \begin{align*}
                4 C^2 \Id {\Lebesgue 2 \CompactGroup} - \adj \sigma \sigma
            \end{align*}
            is an operator of order $0$,
            and so by Corollary~\ref{corollary:square_root_of_a_symbol_of_order_zero}, the symbol
            \begin{align*}
                \sigma_S \defeq \sqrt{4 C^2 \Id {\Lebesgue 2 \CompactGroup} - \adj \sigma \sigma}
            \end{align*}
            is also in $\SymbolClass 0 {\rho, \delta}$.
            By definition, we have
            \begin{align}
                \adj \sigma \sigma = 4 C^2 \Id {\Lebesgue 2 \CompactGroup} - \adj {\sigma_S} \sigma_S.
                \label{eq:decomposition_of_unity_in_terms_of_symbols_squared}
            \end{align}

            By the adjoint and composition formulas,
            we have
            \begin{align*}
                \Op(\adj \sigma \sigma) = \adj T T + R_1\\
                \Op(\adj {\sigma_S} \sigma_S) = \adj S S +  R_2,
            \end{align*}
            with $R_1, R_2 \in \OperatorClass {\rho - \delta} {\rho, \delta}$.
            Therefore, applying $\Op$ on both sides of~\eqref{eq:decomposition_of_unity_in_terms_of_symbols_squared} yields
            \begin{align*}
                \adj T T = 4 C^2 \Id {\Schwartz \Group} - \adj S S + R,
                \quad R \defeq (R_2 - R_1) \in \OperatorClass {\rho - \delta} {\rho, \delta}.
            \end{align*}

            Now, fix $\phi \in \Lebesgue 2 \Group$.
            Since Step 2 implies that $R$ is bounded,
            we get
            \begin{align*}
                \norm [\Lebesgue 2 \Group] {T \phi}^2
                &= \ip [\Lebesgue 2 \Group] {\adj T T \phi} \phi\\
                &= 4 C^2 \norm [\Lebesgue 2 \Group] \phi^2 - \norm [\Lebesgue 2 \Group] {S \phi}^2 + \ip [\Lebesgue 2 \Group] {R \phi} {\phi}\\
                &\leq (4 C^2 + \norm [\Lin {\Lebesgue 2 \Group}] R) \norm [\Lebesgue 2 \Group] \phi^2,
            \end{align*}
            concluding the proof.
    \end{description}
\end{proof}
