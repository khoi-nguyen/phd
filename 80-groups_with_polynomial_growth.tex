\chapter{Towards groups with polynomial growth}

\section{The setting}

In this chapter,
$\Group$ will denote a connected locally compact Lie group,
for which we fix a non-zero left-invariant Haar measure $\mu = \dd g$.
Moreover,
we shall assume that $\Group$ has \emph{polynomial growth},
in the sense of the following definition.

\begin{definition}[Group of polynomial growth]
    We shall say that $\Group$ has \emph{polynomial growth}
    if for every compact neighbourhood $U \subset \Group$
    containing the identity $e_\Group$,
    there exists $C \geq 0$ such that
    \begin{align*}
        \mu(U^n) \leq C n^C
    \end{align*}
    for every $n \in \N$.
\end{definition}

This implies that $\Group$ is unimodular.

\section{The heat kernel}

\begin{lemma}
\label{lemma:estimate_on_heat_kernel}
    Let $q \in \SmoothFunctions \Group$ which vanishes up to order $a \in \N$ at $e_\Group$.
    If $\beta \in \N^{\dim \Group}$,
    then there exists $C \geq 0$ such that
    \begin{align}
        \int_\Group \abs {q(x) \LeftDifferentialOperator \beta h_t(x)} \dd x
        \leq C_{q, \beta} t^{\frac {a - \abs \beta} 2}
    \end{align}
    holds for every $t \in (0, 1]$.
\end{lemma}
\begin{proof}
    Using \cite[Theorem VIII.2.7]{VaropoulosSaloffCosteCoulhon92},
    we know that the \emph{heat kernel} satisfies the following estimate
    \begin{align}
        \abs {\LeftDifferentialOperator \beta h_t(x)} \leq C \sqrt t^{-\abs \beta} \Volume {\sqrt t}^{-1} \e^{-\frac{\norm [\Group] x^2} {C_\beta t}}
        \label{eq:estimate_on_the_derivatives_of_the_heat_kernel}
    \end{align}

    Let us write
    \begin{align*}
        I_A \defeq \int_{\norm [\Group] h \in A} \abs {q(x) \LeftDifferentialOperator \beta h_t(x)},
    \end{align*}
    where $A$ is an interval in $\R$.
    For each $j \in \N$,
    we let
    \begin{align*}
        I_j \defeq
        \begin{cases}
            I_{[0, \sqrt t]} & \text{if } j = 0\\
            I_{[2^{j - 1} \sqrt t, 2^j \sqrt t]} & \text{otherwise}.
        \end{cases}
    \end{align*}

    Using the fact that $\abs {q(x)} \leq C_q \norm [\Group] x^a$
    together with~\eqref{eq:estimate_on_the_derivatives_of_the_heat_kernel},
    \begin{align*}
        I_0 \leq C_q \sqrt t^{a -\abs \beta}
    \end{align*}

    Using~\eqref{eq:estimate_on_the_derivatives_of_the_heat_kernel},
    it follows that
    \begin{align*}
        I_j &\leq C_q (2^j \sqrt t)^a \sqrt t^{-\abs \beta} \frac {\Volume {2^j \sqrt t}} {\Volume {\sqrt t}} \e^{-\frac{4^{j - 1}} {C_\beta}}\\
        &\leq C_q \sqrt t^{a - \abs \beta}
        \left(2^{j a} \frac {\Volume {2^j \sqrt t}} {\Volume {\sqrt t}} \e^{-\frac{4^{j - 1}} {C_\beta}}\right)
    \end{align*}

    Since the volume grows at most polynomially,
    the expression in brackets above decreases exponentially in $j$,
    hence
    \begin{align*}
        \sum_{j = 1}^\infty I_j \leq C_{q, \beta} \sqrt t^{a - \abs \beta}
    \end{align*}

    We have thus shown that
    \begin{align*}
        \int_\Group \abs {q(x) \LeftDifferentialOperator \beta h_t(x)} \dd x
        = \sum_{j = 0}^{+\infty} I_j \leq C_q t^{\frac{a - \abs \beta} 2},
    \end{align*}
    concluding the proof.
\end{proof}

\begin{proposition}
    Let $m \in \R$ and suppose that $q \in \SmoothFunctions \Group$ is a smooth function vanising up to order $a$ at the origin $e_\Group$.
    The distribution $q h_t$ satisfies
    \begin{align*}
        \norm [\KernelsSobolev 0 {m - a}] {q h_t}
        \leq t^{\frac m 2}
    \end{align*}
\end{proposition}
\begin{proof}
    Let $N \in \N$.
    By Lemma~\ref{lemma:estimate_on_heat_kernel},
    it is clear that after applying the Leibniz rule,
    we have
    \begin{align*}
        \int_\Group &\abs {(1 - \Laplacian)^N \{q h_t\}(x)} \dd x\\
        &\leq \sum_{\abs{\beta_1 + \beta_2} \leq 2N} \int_\Group \abs {\LeftDifferentialOperator {\beta_1} q(x) \LeftDifferentialOperator {\beta_2} h_t(x)} \dd x\\
        &\leq \sum_{\abs{\beta_1 + \beta_2} \leq 2N} t^{\frac {a - \abs {\beta_1} - \abs{\beta_2}} 2},
    \end{align*}
    since $\LeftDifferentialOperator {\beta_1}$ vanishes up to order $a - \abs {\beta_1}$.
    Continuing the above calculation,
    one gets
    \begin{align*}
        \int_\Group \abs {(1 - \Laplacian)^N \{q h_t\}(x)} \dd x
        \leq C_{q, N} \sum_{\abs{\beta_1 + \beta_2} \leq 2N} t^{\frac {a - \abs {\beta_1} - \abs{\beta_2}} 2}
        \leq C_{q, N} t^{\frac a 2 - N}.
    \end{align*}

    By the properties of interpolation and duality of Sobolev spaces,
    we may replace $2N$ by any real number,
    in particular by $m - a$.
    With this substitution,
    we obtain that
    \begin{align*}
        \int_\Group \abs {\BesselPotential {m - a} \{q h_t\}(x)} \dd x
        \leq C_{q, N} t^{\frac m 2},
    \end{align*}
    from which it follows that
    \begin{align*}
        \norm [\KernelsSobolev 0 {m - a}] {q h_t}
        \leq \int_\Group \abs {\BesselPotential {m - a} \{q h_t\}(x)} \dd x
        \leq t^{\frac m 2}.
    \end{align*}
\end{proof}

\section{Kernel estimates}

\begin{theorem}[Kernel estimates at the origin]
    Let $\rho \in (0, 1]$.

    Suppose that $\Group$ satisfies the following assumptions.
    \begin{itemize}
        \item
            There exists a family $(h_t)_{t \in (0, 1]} \subset \Schwartz \Group$
            satisfying the following properties.
            \begin{itemize}
                \item As $t$ tend to $0$, $h_t$ converges to $\delta_{e_\Group}$ in $\TemperedDistributions \Group$.
                \item If $q \in \SmoothFunctions {\Group}$ vanishes up to order $a \in \N$,
                    then for each $s \in \R$ there exists $C \geq 0$ such that
                    \begin{align}
                        \norm [\KernelsSobolev s {s - m + \rho a}] {q h_t}
                        \leq C t^{\frac m 2}
                        \label{eq:kernel_estimates:heat_kernel_condition}
                    \end{align}
                    holds for every $0 < t \leq 1$.
            \end{itemize}
        \item There exists $n \in \N$ such that for each $s > n/2$,
            we have a continuous inclusion
            \begin{align*}
                \Sobolev \gamma \to \ContinuousFunctions \Group.
            \end{align*}
        \item There exists an admissible family $q_1, \dots, q_{\dimDifferenceOperators} \in \SmoothFunctions \Group$, a positive constant $C \geq 0$ and $p \in \N$ such that
            \begin{align*}
                \norm [\Group] h^{p r} \leq \sum_{\abs \alpha = pr} q^\alpha(h)
            \end{align*}
            and such that the following \emph{Leibniz-like} formula holds
            \begin{align*}
                q^\alpha(x y) = \sum_{\abs \alpha \leq \abs {\alpha_1} + \abs {\alpha_2} \leq C \abs \alpha}
                c_{\alpha_1, \alpha_2} q^{\alpha_1}(x) q^{\alpha_2}(y).
            \end{align*}
    \end{itemize}

    If $\kappa \in \TemperedDistributions \Group$ satisfies
    \begin{align}
        q \kappa \in \Sobolev \gamma,
        \quad \gamma < -\frac n 2 -m + \rho a
        \label{eq:kernel_estimates:assumption_on_the_kernel}
    \end{align}
    whenever $q$ vanishes up to order $a$ and $m > -n$,
    then
    \begin{align*}
        \abs{\kappa(g)} \leq C \norm [\Group] h^{-\frac{m + n} \rho}.
    \end{align*}
\end{theorem}
\begin{proof}
    Fix $g \in \Group \setminus \{e_\Group\}$,
    and let $t \defeq \norm [\Group] g^2$.

    Let us write $\kappa_t \defeq \conv \kappa {h_t}$.
    By the Sobolev inequality,
    we know that for each $s < -n/2$
    \begin{align*}
        \norm [\ContinuousFunctions \Group] {\kappa_t}
        \leq \norm [\Sobolev {-s}] {\conv \kappa {h_t}}
        \leq \norm [\KernelsSobolev {s - m} {-s}] {h_t}
        \norm [\Sobolev {s - m}] \kappa,
    \end{align*}
    where the right-hand side is finite by~\eqref{eq:kernel_estimates:assumption_on_the_kernel}.
    Using~\eqref{eq:kernel_estimates:heat_kernel_condition},
    we then obtain
    \begin{align*}
        \norm [\ContinuousFunctions \Group] {\kappa_t}
        \leq C t^{s - \frac m 2} \norm [\Sobolev {s - m}] \kappa
    \end{align*}

    Observing we may choose $s < -n/2$ so that
    \begin{align*}
        s - \frac m 2 = -\frac {m + n} {2 \rho},
    \end{align*}
    we obtain
    \begin{align}
        \abs {\kappa_t(g)}
        \leq C \norm [\Sobolev {\frac m 2 -\frac {m + n} {2 \rho}}] \kappa \norm [\Group] g^{- \frac {m + n} \rho}.
        \label{eq:kernel_estimates:estimate_on_kappa_t}
    \end{align}

    Now, let us treat the remainder $\kappa - \kappa_t$.
    Fix $\alpha \in \N^{\dimDifferenceOperators}$.
    Choosing $s < -n/2$,
    we can again apply the Sobolev inequality to obtain
    \begin{align*}
        &\abs {q^\alpha (\kappa - \kappa_t)(g)}\\
        &\leq \norm [\Sobolev {-s}] {q^\alpha(\conv \kappa {(\delta_{e_\Group} - \kappa_t)})}\\
        &\leq \sum_{\abs \alpha \leq \abs {\alpha_1} + \abs {\alpha_2} \leq C \abs \alpha}
        \norm [\Sobolev {-s}] {\conv {q^{\alpha_1} \kappa} {q^{\alpha_2} (\delta_{e_\Group} - \kappa_t)}}\\
        &\leq \sum_{\abs \alpha \leq \abs {\alpha_1} + \abs {\alpha_2} \leq C \abs \alpha}
        \norm [\KernelsSobolev {s - m + \rho \abs {\alpha_1}} {-s}] {q^{\alpha_2}(\delta_{e_\Group} - \kappa_t)}
        \norm [\Sobolev {s - m + \rho \abs {\alpha_1}}] {q^{\alpha_1} \kappa}
    \end{align*}

    Observe that by~\eqref{eq:kernel_estimates:heat_kernel_condition}
    and keeping in mind that $\abs {\alpha_1} + \abs {\alpha_2} \geq \abs \alpha$,
    \begin{align*}
        \norm [\KernelsSobolev {s - m + \rho \abs {\alpha_1}} {-s}] {q^{\alpha_2} (h_{\epsilon} - h_t)}
        \leq C (\epsilon^{\frac{2s - m + \rho \abs \alpha} 2} + t^{\frac{2s - m + \rho \abs \alpha} 2}),
    \end{align*}
    and thus letting $\epsilon \to 0$ yields
    \begin{align*}
        \norm [\KernelsSobolev {s - m + \rho \abs {\alpha_1}} {-s}] {q^{\alpha_2} (\delta_{e_\Group} - h_t)}
        \leq C t^{\frac {2s - m + \rho \abs \alpha} 2}
        = C \norm [\Group] g^{2s - m + \rho \abs \alpha},
    \end{align*}
    provided $2s - m + \rho \abs {\alpha} > 0$
    (which we shall assume henceforth).

    Using the fact that
    \begin{align*}
        \norm [\Group] g^{p r}
        \leq \sum_{\abs \alpha = p r} q^\alpha(g),
    \end{align*}
    we then obtain
    \begin{align}
        \abs {\kappa - \kappa_t(g)}
        \leq C \norm [\Group] g^{2s - m + p r(\rho - 1)}
        \quad
        \text{if }
        m - \rho p r < 2s < -n.
        \label{eq:kernel_estimate_with_choice_of_s}
    \end{align}

    Observing that the above estimate is optimal when $r$ is as small as possible,
    we are led to define
    \begin{align*}
        r \defeq \min \{q \in \N : m - \rho p q < -n \Longleftrightarrow q > \frac{m + n} {\rho p}\}
    \end{align*}

    Now, choose $s \in \R$ so that
    \begin{align}
        2s - m + p r (\rho - 1) = - \frac {m + n} \rho
        \label{eq:kernel_estimates:choice_of_s}
    \end{align}
    We check that
    \begin{align*}
        m - 2s &= p r (\rho - 1) + \frac {m + n} \rho,\\
        &> m + n
    \end{align*}
    which implies that $2 s < -n$.
    Similarly,
    we check that
    \begin{align*}
        m - \rho p r = 2s + \frac {m + n} \rho - p r
        < 2 s.
    \end{align*}

    We have shown that our choice of $s$ in~\eqref{eq:kernel_estimates:choice_of_s} satisfies~\eqref{eq:kernel_estimate_with_choice_of_s},
    so that we have
    \begin{align*}
        \abs {\kappa - \kappa_t(g)}
        \leq C \norm [\Group] g^{-\frac{m + n} \rho},
    \end{align*}
    concluding the proof.
\end{proof}

\section{Calder\'on-Zygmund property}
